<!DOCTYPE html>
<html lang="en">

{% include head.html %}

<body class="page-top">
    {% include nav.html %}

    <!-- Course-specific Table of Contents -->
    <div id="courseTOC" class="course-toc-sidebar">
        <div class="toc-header">
            <h4><i class="fa fa-list"></i> Course Contents</h4>
            <button id="closeTOC" class="toc-close-btn" aria-label="Close table of contents">
                <i class="fa fa-times"></i>
            </button>
        </div>
        <div class="toc-content">
            <ul id="tocList" class="toc-list">
                <!-- TOC items will be populated by JavaScript -->
            </ul>
        </div>
        <div class="toc-footer">
            <a href="{{ '/courses.html' | relative_url }}" class="toc-back-link">
                <i class="fa fa-arrow-left"></i> Back to Courses
            </a>
        </div>
    </div>

    <!-- TOC Toggle Button -->
    <button id="tocToggle" class="toc-toggle-btn" aria-label="Toggle table of contents">
        <i class="fa fa-list"></i>
    </button>

    <!-- TOC Overlay -->
    <div id="tocOverlay" class="toc-overlay"></div>

    <article class="course-article">
        <!-- Hero Section -->
        <header class="layout-hero course-hero">
            <div class="hero-bg-image" {% if page.hero_image
                %}style="background-image: url('{{ page.hero_image | relative_url }}');" {% endif %}></div>
            {% unless page.hero_image %}
            <div class="hero-pattern">
                <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <pattern id="coursePattern" patternUnits="userSpaceOnUse" width="40" height="40">
                            <circle cx="20" cy="20" r="2" fill="white" opacity="0.3" />
                            <path d="M10,20 L30,20 M20,10 L20,30" stroke="white" stroke-width="0.5" opacity="0.2" />
                        </pattern>
                    </defs>
                    <rect width="100%" height="100%" fill="url(#coursePattern)" />
                </svg>
            </div>
            {% endunless %}

            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2 text-center">
                        <div class="course-icon-container">
                            <i class="{{ page.course_icon | default: 'fa fa-graduation-cap' }}"></i>
                        </div>

                        {% if page.status %}
                        <div class="course-category">
                            <span class="category-badge">{{ page.status }}</span>
                        </div>
                        {% endif %}

                        <h1 class="hero-title">{{ page.title }}</h1>

                        {% if page.subtitle %}
                        <p class="hero-subtitle">{{ page.subtitle }}</p>
                        {% endif %}

                        <div class="course-meta">
                            {% if page.price %}
                            <div class="meta-item">
                                <i class="fa fa-dollar"></i>
                                <span>${{ page.price }} {{ page.currency | default: 'AUD' }} {{ page.price_per |
                                    default: 'per person' }}</span>
                            </div>
                            {% endif %}
                            {% if page.duration %}
                            <div class="meta-item">
                                <i class="fa fa-clock-o"></i>
                                <span>{{ page.duration }}</span>
                            </div>
                            {% endif %}
                            {% if page.max_participants %}
                            <div class="meta-item">
                                <i class="fa fa-users"></i>
                                <span>Max {{ page.max_participants }} participants</span>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Course Details Section -->
        <section class="course-details">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="details-grid">
                            <div class="detail-card pricing-card">
                                <h4><i class="fa fa-dollar"></i>Investment</h4>
                                <p class="price">${{ page.price }} {{ page.currency | default: 'AUD' }}</p>
                                <p class="price-note">{{ page.price_per | default: 'per person' }}</p>
                                {% if page.payment_required %}
                                <p class="payment-required">
                                    <i class="fa fa-exclamation-circle"></i>Payment required {{ page.payment_required }}
                                </p>
                                {% endif %}
                            </div>

                            <div class="detail-card format-card">
                                <h4><i class="fa fa-calendar"></i>Format</h4>
                                <p class="format-details">{{ page.duration }}</p>
                                {% if page.course_format %}
                                <p class="format-description">{{ page.course_format }}</p>
                                {% endif %}
                                {% if page.location %}
                                <p class="location"><i class="fa fa-map-marker"></i>{{ page.location }}</p>
                                {% endif %}
                            </div>

                            <div class="detail-card capacity-card">
                                <h4><i class="fa fa-users"></i>Class Size</h4>
                                <p class="capacity">Min {{ page.min_participants | default: 1 }} - Max {{
                                    page.max_participants | default: 20 }} people</p>
                                <p class="capacity-note">Small cohorts for personalized attention</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Main Content -->
        <main class="course-content layout-content">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="article-body">
                            {{ content }}
                        </div>

                        {% if page.learning_outcomes %}
                        <div class="info-box outcomes-box">
                            <h3><i class="fa fa-check-circle"></i>Learning Outcomes</h3>
                            <ul>
                                {% for outcome in page.learning_outcomes %}
                                <li><i class="fa fa-check"></i><span>{{ outcome }}</span></li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}

                        {% if page.prerequisites %}
                        <div class="info-box prerequisites-box">
                            <h3><i class="fa fa-list-ul"></i>Prerequisites</h3>
                            <ul>
                                {% for prereq in page.prerequisites %}
                                <li><i class="fa fa-arrow-right"></i><span>{{ prereq }}</span></li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}

                        {% if page.tech_stack %}
                        <div class="info-box tools-box">
                            <h3>Tools & Technologies</h3>
                            <div class="tools-list">
                                {% for tech in page.tech_stack %}
                                <span class="tool-tag">{{ tech }}</span>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </main>

        <!-- Enrollment CTA Section -->
        <section class="cta-section course-cta">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2 text-center">
                        <h2>Ready to Transform Your Workflow?</h2>
                        <p>Enroll now to secure your spot and start leveraging AI in your professional work.</p>
                        <div class="cta-buttons">
                            {% if page.enrollment_link %}
                            <a href="{{ page.enrollment_link }}" class="action-btn btn-enroll">
                                <i class="fa fa-rocket"></i> Enroll Now
                            </a>
                            {% endif %}
                            <a href="mailto:{{ site.email }}" class="action-btn btn-info">
                                <i class="fa fa-question-circle"></i> Ask a Question
                            </a>
                        </div>
                        <p class="contact-note">For group bookings or custom training, please <a
                                href="mailto:{{ site.email }}">contact us</a>.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Navigation -->
        <section class="content-navigation">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="nav-container">
                            <a href="{{ '/courses.html' | relative_url }}" class="nav-link">
                                <i class="fa fa-arrow-left"></i>
                                Back to Courses
                            </a>
                            <a href="{{ '/' | relative_url }}" class="primary-nav">
                                Back to Home
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </article>

    {% include scripts.html %}

    <!-- Course TOC Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const toc = document.getElementById('courseTOC');
            const tocToggle = document.getElementById('tocToggle');
            const tocClose = document.getElementById('closeTOC');
            const tocOverlay = document.getElementById('tocOverlay');
            const tocList = document.getElementById('tocList');

            // Initialize TOC
            function initializeTOC() {
                const headers = document.querySelectorAll('.article-body h1, .article-body h2, .article-body h3, .article-body h4');

                if (headers.length === 0) {
                    tocToggle.style.display = 'none';
                    return;
                }

                headers.forEach((header, index) => {
                    if (!header.id) {
                        header.id = 'heading-' + index;
                    }

                    const li = document.createElement('li');
                    const link = document.createElement('a');

                    link.href = '#' + header.id;
                    link.textContent = header.textContent;
                    link.className = 'toc-link';
                    link.setAttribute('data-level', header.tagName.toLowerCase());

                    link.addEventListener('click', function (e) {
                        e.preventDefault();
                        header.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        closeTOC();
                        updateActiveLink(link);
                    });

                    li.appendChild(link);
                    tocList.appendChild(li);
                });

                // Update active link on scroll
                window.addEventListener('scroll', updateActiveOnScroll);
            }

            function openTOC() {
                toc.classList.add('active');
                tocOverlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            function closeTOC() {
                toc.classList.remove('active');
                tocOverlay.classList.remove('active');
                document.body.style.overflow = '';
            }

            function updateActiveLink(activeLink) {
                document.querySelectorAll('.toc-link').forEach(link => {
                    link.classList.remove('active');
                });
                if (activeLink) {
                    activeLink.classList.add('active');
                }
            }

            function updateActiveOnScroll() {
                const headers = document.querySelectorAll('.article-body h1, .article-body h2, .article-body h3, .article-body h4');
                const scrollPos = window.scrollY + 100;

                let activeHeader = null;
                headers.forEach(header => {
                    if (header.offsetTop <= scrollPos) {
                        activeHeader = header;
                    }
                });

                if (activeHeader) {
                    const activeLink = document.querySelector(`[href="#${activeHeader.id}"]`);
                    updateActiveLink(activeLink);
                }
            }

            // Event listeners
            tocToggle.addEventListener('click', openTOC);
            tocClose.addEventListener('click', closeTOC);
            tocOverlay.addEventListener('click', closeTOC);

            // Keyboard support
            document.addEventListener('keydown', function (e) {
                if (e.key === 'Escape' && toc.classList.contains('active')) {
                    closeTOC();
                }
            });

            // Initialize
            initializeTOC();
        });
    </script>

</body>

</html>